# event_driven.md

## 개요

이벤트 드리븐 아키텍처는 “무슨 일이 발생했다”라는 이벤트를 기준으로 시스템이 동작하는 방식입니다.
서비스가 직접 서로를 호출하지 않고, 이벤트를 발행하고 구독하는 형태로 연결됩니다.
요청 흐름이 비동기로 흘러가고, 서비스 간 결합이 느슨해지는 게 핵심입니다.

---

## 주요 개념

* 이벤트
  상태 변화나 행동을 나타내는 메시지
  예: 주문 생성됨, 결제 완료됨

* 이벤트 소스
  이벤트를 만들어서 발행하는 쪽
  예: 주문 서비스가 “주문 생성” 이벤트 발행

* 이벤트 핸들러
  이벤트를 받아서 처리하는 쪽
  예: 재고 서비스가 주문 생성 이벤트를 받아 재고 차감

* 이벤트 버스
  이벤트 전달을 중개하는 통로
  Kafka, RabbitMQ 같은 메시지 브로커가 여기 역할을 합니다.

---

## 장점

* 느슨한 결합
  서비스가 서로를 직접 호출하지 않아서 종속성이 줄어듭니다.
  각각 독립적으로 개발/배포하기 쉬워집니다.

* 확장성
  프로듀서와 컨슈머를 따로 늘릴 수 있어서 수평 확장이 편합니다.

* 비동기 처리
  이벤트를 큐에 쌓아두고 처리할 수 있어서 응답성을 유지하기 좋습니다.

---

## 단점

* 복잡성 증가
  이벤트 흐름이 눈에 잘 안 보이고, 상태 관리가 어려워질 수 있습니다.

* 장애 전파 가능성
  이벤트 처리 실패가 계속 쌓이면 다른 서비스에도 영향을 줄 수 있습니다.
  재처리나 복구 방식이 같이 필요해집니다.

---

## 예시로 이해하기(온라인 쇼핑몰)

주문이 생성되는 순간을 이벤트로 보면 이런 흐름입니다.

1. 주문 서비스가 “주문 생성” 이벤트를 발행
2. 메시지 브로커(Kafka/RabbitMQ)가 이벤트를 전달
3. 여러 서비스가 각각 처리

* 재고 서비스: 재고 확인/차감
* 배송 서비스: 배송 준비 시작
* 결제 서비스: 결제 처리

하나의 이벤트로 여러 서비스가 동시에 움직일 수 있다는 게 포인트입니다.

---

## Spring Cloud Stream

Spring Cloud Stream은 이벤트 기반 마이크로서비스를 만들 때, 메시지 브로커 연결을 좀 더 단순하게 해주는 프레임워크입니다.
Kafka나 RabbitMQ 같은 브로커를 붙여서 이벤트 발행/소비 흐름을 만들 수 있습니다.

특징은 이 정도로 정리하면 됩니다.

* 바인더 추상화
  브로커 종류가 달라도 비슷한 방식으로 연결할 수 있게 해줍니다.
* 프로듀서/컨슈머 모델 지원
  이벤트 발행과 수신 처리 흐름을 구성할 수 있습니다.
* 설정으로 커스터마이징 가능
  브로커 연결이나 채널 같은 부분을 설정 기반으로 조절할 수 있습니다.

---

## 용어 정리

| 용어                  | 의미                           |
| ------------------- | ---------------------------- |
| Event-driven        | 이벤트를 기준으로 동작하는 설계 방식         |
| Event               | 상태 변화/행동을 의미하는 메시지           |
| Producer            | 이벤트를 발행하는 쪽                  |
| Consumer            | 이벤트를 받아 처리하는 쪽               |
| Event Bus           | 이벤트 전달을 중개하는 통로              |
| Message Broker      | Kafka/RabbitMQ 같은 메시지 중개 시스템 |
| Spring Cloud Stream | 이벤트 기반 통신을 쉽게 붙이는 프레임워크      |
| Binder              | 브로커 연동을 추상화한 레이어             |

---

## 공부하면서 떠올릴 질문

* 이벤트를 발행했는데 소비자가 실패하면, 그 이벤트는 어떻게 다시 처리하는 게 자연스러울까?
* 이벤트 기반 구조에서는 “처리 순서”가 중요한 경우를 어떻게 다뤄야 할까?
* 서비스 간 직접 호출이 필요한 순간과, 이벤트로 푸는 게 좋은 순간은 어떻게 구분할까?
