# ioc-di-basic.md

## 개요
Spring에서 IoC와 DI는 객체 생성과 의존 관계 연결을 프레임워크가 대신 맡아주게 해서, 변경에 강하고 테스트하기 쉬운 구조를 만들기 위한 핵심 개념입니다.

## 정의
- IoC(Inversion of Control, 제어의 역전): 객체 생성, 의존 관계 연결, 생명주기 관리 같은 제어 권한을 애플리케이션 코드가 아니라 컨테이너(스프링)가 가지는 설계 원칙입니다.
- DI(Dependency Injection, 의존성 주입): 객체가 필요로 하는 의존 객체를 내부에서 직접 만들지 않고, 외부에서 전달받도록 만드는 방식입니다.

## 핵심 개념
- 의존성(Dependency)
  - A가 자신의 일을 하려면 B가 필요하다면, A는 B에 의존합니다.
- 결합도(Coupling)
  - 직접 생성(new)해서 쓰면 결합도가 올라가서 교체와 테스트가 어려워집니다.
  - 추상화(인터페이스)와 주입을 사용하면 결합도가 내려가서 교체가 쉬워집니다.
- IoC와 DI 관계
  - IoC는 원칙입니다.
  - DI는 IoC를 구현하는 대표적인 방법입니다.
- 스프링 컨테이너 관점
  - IoC 컨테이너(스프링 컨테이너)가 Bean을 생성하고, 필요한 의존 Bean을 찾아서 연결(주입)합니다.

## 동작 방식
- DI는 본질적으로 “필요한 것을 외부에서 넣어준다” 입니다.
- 대표 주입 방식
  - 생성자 주입
    - 생성 시점에 필수 의존성이 확정됩니다.
    - 불변(immutable) 설계와 테스트가 편해지는 경우가 많습니다.
  - 세터 주입
    - 선택 의존성, 혹은 런타임 교체가 필요한 경우에 사용합니다.
  - 필드 주입
    - 코드가 짧아 보이지만, 테스트와 명시성이 약해질 수 있어 팀 규칙에 따라 제한하는 경우가 많습니다.

## 전체 흐름
1) 개발자는 역할(인터페이스)과 구현(클래스)을 분리합니다.
2) 객체는 의존 대상을 직접 생성하지 않고, 외부에서 받도록 설계합니다(DI).
3) 스프링 컨테이너가 객체를 생성하고, 의존 대상을 찾아 연결합니다(IoC).
4) 교체와 확장이 쉬워지고, 단위 테스트가 편해집니다.

## 실무 포인트
- 기본은 생성자 주입을 우선으로 둡니다.
  - 필수 의존성을 강제하기 쉽고, 테스트가 편해집니다.
- 의존은 구현체가 아니라 인터페이스에 둡니다.
  - 구현체 교체가 쉬워져서 변경 비용이 내려갑니다.
- “왜 DI를 쓰는가”를 한 문장으로 정리하면 보통 아래입니다.
  - 변경에 강한 구조(유연성)와 테스트 용이성을 얻기 위해서입니다.
- 스프링이 자동으로 주입할 때 헷갈리는 포인트
  - 같은 타입의 Bean이 여러 개면 어떤 것을 넣을지 모호해집니다.
  - 이때 이름, 우선순위(Primary), Qualifier 같은 규칙이 필요해집니다.

### 좋은 코드란 무엇인가요?
- 변경에 강한 코드입니다.
  - 요구사항이 바뀌어도 수정 범위가 작고, 특정 모듈만 교체할 수 있어야 합니다.
- 읽기 쉬운 코드입니다.
  - 역할과 책임이 분리되어 있고, 코드만 봐도 의도가 드러납니다.
- 테스트 가능한 코드입니다.
  - 외부 의존(DB, 외부 API 등)을 쉽게 대체할 수 있어 단위 테스트가 가능합니다.
- 확장 가능한 코드입니다.
  - 새로운 기능이 들어올 때 기존 코드를 “수정”하기보다 “추가”로 해결되는 구조가 좋습니다.
- IoC/DI가 좋은 코드에 기여하는 부분
  - 객체 생성과 결합을 분리해서 결합도를 낮추고, 교체/테스트/확장을 쉽게 만듭니다.

### “DI라는 디자인 패턴으로 IoC라는 설계 원칙을 지켰다”는 의미
- IoC(원칙): 객체 생성/의존 연결의 제어권을 객체 자신이 아니라 “외부”가 갖게 하자는 방향입니다.
- DI(방법/패턴): 그 외부가 의존 객체를 “주입”해주는 구체적인 구현 방식입니다.
- 그래서 이 문장은 결국 아래 뜻입니다.
  - “클래스 내부에서 new로 의존 객체를 직접 만들지 않고, 밖(스프링 컨테이너/설정 코드)에서 만들어 넣어주도록 해서 제어권을 외부로 넘겼다.”
  - “그 결과 결합도가 낮아져 교체/테스트/확장이 쉬워졌다.”

## 용어 정리
| 용어 | 뜻 |
| --- | --- |
| IoC | 제어 권한을 컨테이너가 가지는 설계 원칙 |
| DI | 의존 객체를 외부에서 전달하는 방식 |
| IoC 컨테이너 | Bean을 생성하고 연결하고 관리하는 주체(스프링 컨테이너) |
| Bean | 스프링 컨테이너가 관리하는 객체 |
| 결합도 | 객체들이 서로 얽혀 있는 정도(낮을수록 변경에 강함) |

## 질문
- IoC를 DI 없이 구현한다면 어떤 방식이 될까요? (예: 팩토리, 서비스 로케이터)
- 생성자 주입만으로 부족한 상황이 실제로 있을까요? 있다면 어떤 경우일까요?
- 같은 타입의 Bean이 2개 이상일 때 스프링은 어떤 기준으로 주입 대상을 고를까요?
- DI를 쓰면 테스트가 왜 쉬워질까요? (대체 객체 주입 관점으로 설명해보기)
- “좋은 코드”를 한 문장으로 정의한다면 무엇인가요?
